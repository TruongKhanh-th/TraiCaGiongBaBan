<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>C√° Ch√©p</title>
  <style>
    body { font-family: Arial; padding: 20px; background:#f9f9f9; }
    h1 { color:#0077b6; }
    .gallery { display: flex; gap: 15px; flex-wrap: wrap; margin:20px 0; }
    .gallery img { width: 250px; border-radius:10px; box-shadow:0 3px 10px rgba(0,0,0,0.2); }
    .btn { display:inline-block; padding:10px 15px; margin:5px; text-decoration:none; border-radius:6px; }
    .back { background:#ccc; color:#000; }
    .contact { background:#0077b6; color:#fff; }
  </style>
</head>
<body>
   <a href="index.html" class="btn back">‚¨Ö Tr·ªü l·∫°i</a>
  <h1>üêü C√° Ch√©p</h1>
  <p>
    C√° ch√©p l√† lo·∫°i c√° n∆∞·ªõc ng·ªçt ph·ªï bi·∫øn, d·ªÖ nu√¥i v√† c√≥ gi√° tr·ªã kinh t·∫ø cao.
    Ngo√†i ra, c√° ch√©p c√≤n th∆∞·ªùng ƒë∆∞·ª£c ch·ªçn ƒë·ªÉ ph√≥ng sanh trong c√°c d·ªãp l·ªÖ.

  </p>

  <a href="tel:0909123456" class="btn contact">üìû Li√™n h·ªá</a>
  <div class="gallery">
    <img src="images/ca-chep-1.jpg" alt="C√° ch√©p 1">
    <img src="images/ca-chep-2.jpg" alt="C√° ch√©p 2">
    <img src="images/ca-chep-3.jpg" alt="C√° ch√©p 3">
  </div>
 <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js"></script>

  <script>
    // ‚öôÔ∏è D√°n ƒëo·∫°n config Firebase c·ªßa b·∫°n v√†o ƒë√¢y
    // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyACK383pbLnLA1refbDu6XQ4Dp_SqdHGW8",
  authDomain: "traicababan.firebaseapp.com",
  projectId: "traicababan",
  storageBucket: "traicababan.firebasestorage.app",
  messagingSenderId: "168039844429",
  appId: "1:168039844429:web:9f709934c6e6ad25d22a04",
  measurementId: "G-WE9MJJBPJW"
};

const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database(app);
    const fishKey = "ca-chep";

    const stars = document.querySelectorAll('.star');
    let selectedRating = 0;

    stars.forEach(star => {
      star.addEventListener('click', () => {
        selectedRating = parseInt(star.dataset.value);
        stars.forEach(s => s.classList.remove('selected'));
        for (let i = 0; i < selectedRating; i++) stars[i].classList.add('selected');
      });
    });

    function submitReview() {
      const name = document.getElementById('username').value.trim();
      const text = document.getElementById('reviewText').value.trim();
      if (!name || !text || selectedRating === 0) {
        alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n, n·ªôi dung v√† ch·ªçn s·ªë sao!');
        return;
      }

      const review = { name, text, rating: selectedRating, timestamp: new Date().toISOString() };
      db.ref('reviews/' + fishKey).push(review);
      document.getElementById('username').value = '';
      document.getElementById('reviewText').value = '';
      stars.forEach(s => s.classList.remove('selected'));
      selectedRating = 0;
    }

    function addReply(reviewId) {
      const replyName = prompt("Nh·∫≠p t√™n c·ªßa b·∫°n:");
      if (!replyName) return;
      const replyText = prompt("Nh·∫≠p n·ªôi dung tr·∫£ l·ªùi:");
      if (!replyText) return;
      const reply = { name: replyName, text: replyText, timestamp: new Date().toISOString() };
      db.ref(`reviews/${fishKey}/${reviewId}/replies`).push(reply);
    }

    function deleteReview(reviewId) {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë√°nh gi√° n√†y?")) {
        db.ref(`reviews/${fishKey}/${reviewId}`).remove();
      }
    }

    function deleteReply(reviewId, replyId) {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a tr·∫£ l·ªùi n√†y?")) {
        db.ref(`reviews/${fishKey}/${reviewId}/replies/${replyId}`).remove();
      }
    }

    function renderReviews(data) {
      const list = document.getElementById('reviewsList');
      list.innerHTML = '';
      let total = 0, count = 0;

      if (!data) {
        list.innerHTML = '<p>Ch∆∞a c√≥ ƒë√°nh gi√° n√†o.</p>';
        document.getElementById('avgRating').textContent = 0;
        document.getElementById('totalReviews').textContent = 0;
        return;
      }

      const reviews = Object.entries(data).reverse();
      reviews.forEach(([id, r]) => {
        total += r.rating;
        count++;
        const div = document.createElement('div');
        div.className = 'review';
        div.innerHTML = `
          <strong>${r.name}</strong> - ${'‚òÖ'.repeat(r.rating)}<br>
          ${r.text}<br><small>${new Date(r.timestamp).toLocaleString()}</small><br>
          <button class="btn reply" onclick="addReply('${id}')">Tr·∫£ l·ªùi</button>
          <button class="btn delete" onclick="deleteReview('${id}')">X√≥a</button>
        `;

        if (r.replies) {
          const replies = Object.entries(r.replies);
          replies.forEach(([rid, rep]) => {
            const repDiv = document.createElement('div');
            repDiv.className = 'reply';
            repDiv.innerHTML = `
              <strong>${rep.name}:</strong> ${rep.text} <br>
              <small>${new Date(rep.timestamp).toLocaleString()}</small>
              <br><button class="btn delete" style="background:#b32d2e; padding:4px 6px;" onclick="deleteReply('${id}','${rid}')">X√≥a</button>
            `;
            div.appendChild(repDiv);
          });
        }
        list.appendChild(div);
      });

      const avg = (total / count).toFixed(1);
      document.getElementById('avgRating').textContent = avg;
      document.getElementById('totalReviews').textContent = count;
    }

    db.ref('reviews/' + fishKey).on('value', snapshot => renderReviews(snapshot.val()));
  
  </script>
   <!-- JS x·ª≠ l√Ω ƒë√°nh gi√° -->
  <script src="js/review.js"></script>
</body>

<h2>ƒê√°nh gi√° s·∫£n ph·∫©m</h2>
<div class="rating-summary">
    ‚≠ê ƒêi·ªÉm trung b√¨nh: <span id="avgRating">0</span>/5 (<span id="totalReviews">0</span> ƒë√°nh gi√°)
  </div>
  <div id="stars">
    <span class="star" data-value="1">‚òÖ</span>
    <span class="star" data-value="2">‚òÖ</span>
    <span class="star" data-value="3">‚òÖ</span>
    <span class="star" data-value="4">‚òÖ</span>
    <span class="star" data-value="5">‚òÖ</span>
  </div>


  <input type="text" id="username" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n">
  <textarea id="reviewText" placeholder="Vi·∫øt ƒë√°nh gi√° c·ªßa b·∫°n..."></textarea>
  <button class="btn" onclick="submitReview()">G·ª≠i ƒë√°nh gi√°</button>

  <div class="review-section">
    <h3>üí¨ C√°c ƒë√°nh gi√° g·∫ßn ƒë√¢y:</h3>
    <div id="reviewsList"></div>
  </div>

 
  </script>
</html>
